# Cure It - Emergency Contacts Application

## Overview

This is a full-stack emergency contacts application called "Cure It" built with React, Express, and PostgreSQL. The application allows users to view location-based emergency contacts for police, medical services, fire departments, and municipal services. It includes comprehensive admin functionality for managing contacts, viewing user analytics, and tracking platform usage. The app uses Replit Auth for authentication and provides role-based access control with admin privileges for yutikamadwai1828@gmail.com.

## User Preferences

Preferred communication style: Simple, everyday language.
App name: "Cure It"
Admin access: yutikamadwai1828@gmail.com has full admin privileges to add, edit, and delete emergency contacts, view user analytics, and manage the platform.

## System Architecture

### Frontend Architecture
- **Framework**: React 18 with TypeScript
- **Build Tool**: Vite for fast development and optimized builds
- **UI Components**: Radix UI primitives with shadcn/ui component library
- **Styling**: TailwindCSS with CSS custom properties for theming
- **State Management**: TanStack Query (React Query) for server state management
- **Routing**: Wouter for lightweight client-side routing
- **Forms**: React Hook Form with Zod validation

### Backend Architecture
- **Runtime**: Node.js with Express.js framework
- **Language**: TypeScript with ES modules
- **Database ORM**: Drizzle ORM for type-safe database operations
- **Authentication**: Replit Auth with OpenID Connect
- **Session Management**: Express sessions with PostgreSQL storage

### Database Design
- **Primary Database**: PostgreSQL via Neon Database serverless
- **Schema Management**: Drizzle Kit for migrations and schema management
- **Tables**:
  - `users`: User profiles (required for Replit Auth)
  - `sessions`: Session storage (required for Replit Auth)
  - `emergency_contacts`: Emergency service contact information

## Key Components

### Authentication System
- **Provider**: Supabase Auth with email/password authentication
- **Database**: Supabase PostgreSQL with Row Level Security (RLS)
- **Authorization**: Role-based access with admin privileges for yutikamadwai1828@gmail.com
- **User Tracking**: Automatic login timestamps and location tracking in user_profiles table
- **Security**: JWT tokens, secure password hashing, RLS policies

### Location Services
- **Detection**: Browser geolocation API for user position
- **Geocoding**: BigDataCloud API for reverse geocoding (coordinates to city/state)
- **Fallback**: Default location (Mumbai, Maharashtra) when geolocation fails

### Emergency Contacts Management
- **Service Types**: Police, ambulance, fire department, municipal services
- **Search Functionality**: Full-text search across contact names, designations, and facilities
- **Location Filtering**: City and state-based contact filtering
- **Admin Operations**: CRUD operations for authorized users
- **Click-to-Call**: Direct phone dialing functionality for all contacts

### UI/UX Design
- **Design System**: Radix UI + shadcn/ui for consistent, accessible components
- **Responsive Design**: Mobile-first approach with TailwindCSS
- **Color Coding**: Service-specific color schemes (blue for police, red for medical, etc.)
- **Interactive Elements**: Click-to-call functionality, search, and filtering

## Data Flow

1. **Authentication Flow**:
   - User visits application → Redirected to Replit Auth if not authenticated
   - Successful auth → User data stored/updated in database
   - Session established with PostgreSQL-backed storage

2. **Location Flow**:
   - Browser requests geolocation permission
   - Coordinates sent to geocoding service
   - City/state information extracted and stored in React state

3. **Contact Retrieval Flow**:
   - Location data triggers API request to `/api/emergency-contacts`
   - Server queries database with location/search filters
   - Contacts returned and cached by React Query
   - UI renders contacts grouped by service type

4. **Admin Flow** (authorized users only):
   - Admin panel accessible through user menu with three main tabs:
     * Emergency Contacts: CRUD operations for all emergency services
     * User Management: View all registered users, login statistics, and user locations
     * Analytics: Platform statistics including user distribution and contact breakdowns
   - Real-time updates through React Query cache invalidation
   - User activity tracking and reporting

## External Dependencies

### Database & Storage
- **Neon Database**: Serverless PostgreSQL hosting
- **connect-pg-simple**: PostgreSQL session store for Express

### Authentication
- **Replit Auth**: OpenID Connect authentication provider
- **passport**: Authentication middleware framework

### UI & Styling
- **Radix UI**: Accessible component primitives
- **TailwindCSS**: Utility-first CSS framework
- **Lucide React**: Icon library

### Development Tools
- **Vite**: Build tool with HMR and optimization
- **TypeScript**: Type safety and developer experience
- **Drizzle Kit**: Database schema management and migrations

### APIs
- **BigDataCloud**: Reverse geocoding service for location detection

## Deployment Strategy

### Development Environment
- **Local Development**: Vite dev server with Express API
- **Hot Module Replacement**: Enabled for React components
- **Database**: Connected to Neon Database via environment variables

### Production Build
- **Frontend**: Vite builds static assets to `dist/public`
- **Backend**: esbuild bundles Express server to `dist/index.js`
- **Deployment**: Single Node.js process serving both static files and API

### Environment Configuration
- **DATABASE_URL**: PostgreSQL connection string (required)
- **SESSION_SECRET**: Session encryption key (required)
- **REPL_ID**: Replit environment identifier (required for auth)
- **ISSUER_URL**: OpenID Connect issuer URL (optional, defaults to Replit)

### Database Management
- **Schema Changes**: Applied via `npm run db:push` using Drizzle Kit
- **Migrations**: Stored in `/migrations` directory
- **Connection**: Serverless connection pooling via Neon

### Security Considerations
- **HTTPS**: Required for secure cookies and authentication
- **CORS**: Configured for cross-origin requests in development
- **Session Security**: HttpOnly, secure cookies with configurable TTL
- **Input Validation**: Zod schemas for API request validation
- **SQL Injection Prevention**: Parameterized queries via Drizzle ORM